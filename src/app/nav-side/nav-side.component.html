<!-- Sidebar -->
<div class="relative">
  <div class="h-screen bg-emerald-600 flex flex-col transition-all duration-300 ease-in-out fixed z-40 top-0 left-0"
    [ngClass]="{
      'w-56': isExpanded && !isMobile,
      'w-16': !isExpanded && !isMobile,
      'w-1/2': isExpanded && isMobile,
      '-translate-x-full': !isExpanded && isMobile
    }">

    <!-- Logo -->
    <div class="flex items-center justify-center h-16 p-2">
      <div class="w-10 h-10 rounded-md bg-white/10 flex items-center justify-center">
        <mat-icon class="text-white">description</mat-icon>
      </div>
      <span *ngIf="isExpanded" class="ml-2 text-lg font-semibold text-white">Light Quiz</span>
    </div>

    <!-- Collapse button (for desktop only) -->
    <div class="flex justify-end px-3 py-2" *ngIf="!isMobile">
      <button class="text-white/80 hover:text-white hover:bg-white/10 p-2 rounded" (click)="toggleMenu()">
        <mat-icon *ngIf="isExpanded">chevron_left</mat-icon>
        <mat-icon *ngIf="!isExpanded">chevron_right</mat-icon>
      </button>
    </div>

    <!-- Navigation items -->
    <div class="flex flex-col gap-1 px-2">
      <!-- Dashboard -->
      <a *ngIf="role === 'teacher'" [routerLink]="'/dashboard'"
        class="flex items-center gap-3 h-12 px-3 rounded transition-colors relative" [ngClass]="{
          'text-white bg-cyan-950/25 hover:bg-pink-500/25 before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-pink-500':
            router.url === '/dashboard',
          'text-white/80 hover:text-white hover:bg-white/10':
            router.url !== '/dashboard',
          'justify-center px-0': !isExpanded
        }">
        <mat-icon class="w-5 h-5">dashboard</mat-icon>
        <span *ngIf="isExpanded">Dashboard</span>
      </a>

      <!-- Questions -->
      <a *ngIf="role === 'teacher'" [routerLink]="'/create'"
        class="flex items-center gap-3 h-12 px-3 rounded transition-colors relative" [ngClass]="{
   'text-white bg-cyan-950/25 hover:bg-pink-500/25 before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-pink-500':
     router.url === '/create',
   'text-white/80 hover:text-white hover:bg-white/10':
     router.url !== '/create',
   'justify-center px-0': !isExpanded
 }">
        <mat-icon class="w-5 h-5">create</mat-icon>
        <span *ngIf="isExpanded">Create Quiz</span>
      </a>

      <!-- Student Links -->
      <a *ngIf="role === 'student'" [routerLink]="'/quiz'"
        class="flex items-center gap-3 h-12 px-3 rounded transition-colors relative" [ngClass]="{
          'text-white bg-cyan-950/25 hover:bg-pink-500/25 before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-pink-500':
            router.url === '/quiz',
          'text-white/80 hover:text-white hover:bg-white/10':
            router.url !== '/quiz',
          'justify-center px-0': !isExpanded
        }">
        <mat-icon class="w-5 h-5">quiz</mat-icon>
        <span *ngIf="isExpanded">Join Quiz</span>
      </a>

      <a *ngIf="role === 'student'" [routerLink]="'/results'"
        class="flex items-center gap-3 h-12 px-3 rounded transition-colors relative" [ngClass]="{
          'text-white bg-cyan-950/25 hover:bg-pink-500/25 before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-pink-500':
            router.url === '/results',
          'text-white/80 hover:text-white hover:bg-white/10':
            router.url !== '/results',
          'justify-center px-0': !isExpanded
        }">
        <mat-icon class="w-5 h-5">insert_chart</mat-icon>
        <span *ngIf="isExpanded">Results</span>
      </a>
      <a *ngIf="role === 'student'" [routerLink]="'/s-groups'"
        class="flex items-center gap-3 h-12 px-3 rounded transition-colors relative" [ngClass]="{
          'text-white bg-cyan-950/25 hover:bg-pink-500/25 before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-pink-500':
            router.url === '/s-groups',
          'text-white/80 hover:text-white hover:bg-white/10':
            router.url !== '/s-groups',
          'justify-center px-0': !isExpanded
        }">
        <mat-icon class="w-5 h-5">group</mat-icon>
        <span *ngIf="isExpanded">Groups</span>
      </a>

      <!-- Teacher Links -->
      <a *ngIf="role === 'teacher'" [routerLink]="'/quizzes'"
        class="flex items-center gap-3 h-12 px-3 rounded transition-colors relative" [ngClass]="{
          'text-white bg-cyan-950/25 hover:bg-pink-500/25 before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-pink-500':
        router.url === '/quizzes',
          'text-white/80 hover:text-white hover:bg-white/10':
        router.url !== '/quizzes',
          'justify-center px-0': !isExpanded
        }">
        <mat-icon class="w-5 h-5">collections_bookmark</mat-icon>
        <span *ngIf="isExpanded">quizzes</span>
      </a>

      <a *ngIf="role === 'teacher'" [routerLink]="'/t-groups'"
        class="flex items-center gap-3 h-12 px-3 rounded transition-colors relative" [ngClass]="{
          'text-white bg-cyan-950/25 hover:bg-pink-500/25 before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-pink-500':
            router.url === '/t-groups',
          'text-white/80 hover:text-white hover:bg-white/10':
            router.url !== '/t-groups',
          'justify-center px-0': !isExpanded
        }">
        <mat-icon class="w-5 h-5">group</mat-icon>
        <span *ngIf="isExpanded">Groups</span>
      </a>

      <a *ngIf="role === 'teacher'" [routerLink]="'/notifications'"
        class="flex items-center gap-3 h-12 px-3 rounded transition-colors relative" [ngClass]="{
          'text-white bg-cyan-950/25 hover:bg-pink-500/25 before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-pink-500':
            router.url === '/notifications',
          'text-white/80 hover:text-white hover:bg-white/10':
            router.url !== '/notifications',
          'justify-center px-0': !isExpanded
        }">
        <mat-icon class="w-5 h-5">notifications</mat-icon>
        <span *ngIf="isExpanded">Notifications</span>
      </a>
    </div>


    <!-- User info when expanded -->
    <div *ngIf="isExpanded && token" class="flex flex-col items-center pb-4" [ngClass]="{
  'mt-[300px]': role === 'student',
  'mt-[150px]': role === 'teacher'
}">
      <div class="px-3 py-2 flex items-center text-white">
        <img [src]="avatarUrl" class="w-8 h-8 rounded-full object-cover" alt="User avatar">
        <span class="ml-2">{{ sub }}</span>
      </div>
      <span class="text-sm text-gray-300">{{ role }}</span>
    </div>

    <!-- Logout when expanded -->
    <div *ngIf="isExpanded && token" class="px-3 mt-auto mb-30">
      <button
        class="w-full flex items-center gap-3 h-12 px-3 rounded transition-colors text-white/80 hover:text-white hover:bg-white/10"
        (click)="logout()">
        <mat-icon class="w-5 h-5">logout</mat-icon>
        <span>Logout</span>
      </button>
    </div>
  </div>

  <!-- Floating user/logout buttons when collapsed -->
  <div *ngIf="!isExpanded && token && !isMobile" class="fixed left-2 bottom-4 z-50 flex flex-col gap-2 mb-7">
    <a [routerLink]="'/profile'" class="p-2 text-white hover:bg-white/10 rounded-full transition-colors"
      matTooltip="{{ sub }}">
      <img [src]="avatarUrl" class="w-8 h-8 rounded-full object-cover" alt="User avatar">
    </a>
    <button mat-icon-button class="text-white hover:bg-white/10 rounded-full" (click)="logout()" matTooltip="Logout">
      <mat-icon>logout</mat-icon>
    </button>
  </div>
</div>
<div *ngIf="isMobile"
  class="fixed bottom-0 left-0 w-full bg-emerald-600 z-50 flex justify-between items-center py-3 px-6 text-white rounded-t-xl shadow-lg">
  <a *ngIf="role === 'teacher'" [routerLink]="'/dashboard'"
    class="flex flex-col items-center space-y-1 hover:text-emerald-200 transition duration-300">
    <mat-icon>dashboard</mat-icon>
  </a>
  <a *ngIf="role === 'teacher'" [routerLink]="'/create'"
    class="flex flex-col items-center space-y-1 hover:text-emerald-200 transition duration-300">
    <mat-icon>create</mat-icon>
  </a>
  <a *ngIf="role === 'student'" [routerLink]="'/quiz'"
    class="flex flex-col items-center space-y-1 hover:text-emerald-200 transition duration-300">
    <mat-icon>quiz</mat-icon>
  </a>
  <a *ngIf="role === 'student'" [routerLink]="'/results'"
    class="flex flex-col items-center space-y-1 hover:text-emerald-200 transition duration-300">
    <mat-icon>insert_chart</mat-icon>
  </a>
  <a *ngIf="role === 'student'" [routerLink]="'/s-groups'"
    class="flex flex-col items-center space-y-1 hover:text-emerald-200 transition duration-300">
    <mat-icon class="w-5 h-5">group</mat-icon>
  </a>
  <a *ngIf="role === 'teacher'" [routerLink]="'/quizzes'"
    class="flex flex-col items-center space-y-1 hover:text-emerald-200 transition duration-300">
    <mat-icon>collections_bookmark</mat-icon>
  </a>
  <a *ngIf="role === 'teacher'" [routerLink]="'/t-groups'"
    class="flex flex-col items-center space-y-1 hover:text-emerald-200 transition duration-300">
    <mat-icon>group</mat-icon>
  </a>
  <a *ngIf="role === 'teacher'" [routerLink]="'/notifications'"
    class="flex flex-col items-center space-y-1 hover:text-emerald-200 transition duration-300">
    <mat-icon>notifications</mat-icon>
  </a>
  <button (click)="logout()"
    class="flex flex-col items-center space-y-1 hover:text-emerald-200 transition duration-300">
    <mat-icon>logout</mat-icon>
  </button>
</div>